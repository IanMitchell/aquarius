# Migration `20201017072919-add-unique-to-reply`

This migration has been generated by Ian Mitchell at 10/17/2020, 12:29:19 AM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
CREATE UNIQUE INDEX "replies.guildId_trigger_unique" ON "public"."replies"("guildId", "trigger")
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration 20200809055919-initial-schema..20201017072919-add-unique-to-reply
--- datamodel.dml
+++ datamodel.dml
@@ -1,15 +1,16 @@
 datasource db {
   provider = "postgresql"
-  url = "***"
+  url = "***"
 }
 generator client {
-  provider = "prisma-client-js"
+  provider        = "prisma-client-js"
+  previewFeatures = ["atomicNumberOperations"]
 }
 model LastSeen {
-  id        Int      @default(autoincrement()) @id
+  id        Int      @id @default(autoincrement())
   userId    String   @unique
   lastSeen  DateTime @default(now())
   createdAt DateTime @default(now())
   updatedAt DateTime @updatedAt
@@ -18,9 +19,9 @@
   @@map("last_seen")
 }
 model Karma {
-  id        Int      @default(autoincrement()) @id
+  id        Int      @id @default(autoincrement())
   guildId   String
   userId    String
   karma     Int      @default(0)
   lastUsage DateTime @default(now())
@@ -32,21 +33,22 @@
   @@map("karma")
 }
 model Reply {
-  id        Int      @default(autoincrement()) @id
+  id        Int      @id @default(autoincrement())
   guildId   String
   trigger   String
   response  String
   createdAt DateTime @default(now())
   updatedAt DateTime @updatedAt
+  @@unique([guildId, trigger])
   @@index([guildId, trigger])
   @@map("replies")
 }
 model Service {
-  id        Int      @default(autoincrement()) @id
+  id        Int      @id @default(autoincrement())
   userId    String
   name      String
   values    Json
   createdAt DateTime @default(now())
@@ -57,9 +59,9 @@
   @@map("linked_services")
 }
 model Setting {
-  id        Int      @default(autoincrement()) @id
+  id        Int      @id @default(autoincrement())
   key       String   @unique
   value     Json
   createdAt DateTime @default(now())
   updatedAt DateTime @updatedAt
@@ -68,9 +70,9 @@
   @@map("settings")
 }
 model Quote {
-  id        Int      @default(autoincrement()) @id
+  id        Int      @id @default(autoincrement())
   guildId   String
   quote     String
   quoteId   Int
   addedBy   String
@@ -83,18 +85,18 @@
   @@map("quotes")
 }
 model Snapshot {
-  id        Int      @default(autoincrement()) @id
+  id        Int      @id @default(autoincrement())
   snapshot  Json
   createdAt DateTime @default(now())
   updatedAt DateTime @updatedAt
   @@map("snapshots")
 }
 model GuildSetting {
-  id           Int              @default(autoincrement()) @id
+  id           Int              @id @default(autoincrement())
   guildId      String           @unique
   mute         Int?
   ignoredUsers IgnoredUser[]
   createdAt    DateTime         @default(now())
@@ -105,9 +107,9 @@
   @@map("guild_settings")
 }
 model EnabledCommand {
-  id             Int             @default(autoincrement()) @id
+  id             Int             @id @default(autoincrement())
   guildSetting   GuildSetting    @relation(fields: [guildSettingId], references: [id])
   guildSettingId Int
   name           String
   enabled        Boolean
@@ -119,9 +121,9 @@
   @@map("enabled_commands")
 }
 model CommandConfig {
-  id        Int            @default(autoincrement()) @id
+  id        Int            @id @default(autoincrement())
   command   EnabledCommand @relation(fields: [commandId], references: [id])
   commandId Int
   key       String
   value     String
@@ -132,9 +134,9 @@
   @@map("command_configs")
 }
 model IgnoredUser {
-  id             Int          @default(autoincrement()) @id
+  id             Int          @id @default(autoincrement())
   guildSetting   GuildSetting @relation(fields: [guildSettingId], references: [id])
   guildSettingId Int
   userId         String
   createdAt      DateTime     @default(now())
@@ -144,9 +146,9 @@
   @@map("ignored_users")
 }
 model Analytic {
-  id        Int      @default(autoincrement()) @id
+  id        Int      @id @default(autoincrement())
   action    String
   category  String
   label     String
   context   Json
@@ -157,9 +159,9 @@
   @@map("analytic_events")
 }
 model BanList {
-  id        Int      @default(autoincrement()) @id
+  id        Int      @id @default(autoincrement())
   guildId   String   @unique
   reason    String?
   createdAt DateTime @default(now())
   updatedAt DateTime @updatedAt
```


